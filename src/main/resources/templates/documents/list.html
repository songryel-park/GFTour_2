<!DOCTYPE html>
<html lang="ko" 
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      th:replace="~{layout/base :: html}">
<head>
    <meta charset="UTF-8">
    <title>문서 관리 - Good Feel Tour</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans KR -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div th:block="content">
        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="gf-secondary mb-0">
                            <i class="fas fa-file-alt me-2"></i>문서 관리
                        </h2>
                    </div>
                    <div>
                        <div class="btn-group" role="group">
                            <a th:href="@{/documents/generator}" class="btn btn-success me-2">
                                <i class="fas fa-magic me-2"></i>문서 생성기
                            </a>
                            <button type="button" class="btn btn-gf-primary" data-bs-toggle="modal" data-bs-target="#documentModal">
                                <i class="fas fa-plus me-2"></i>문서 작성
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Document Types Grid -->
        <div class="row mb-4">
            <div class="col">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent">
                        <h6 class="mb-0">
                            <i class="fas fa-th-large me-2"></i>문서 타입별 현황
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <!-- Main Workflow Documents (Images 5,6,8) -->
                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-primary h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-primary bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-file-invoice text-primary"></i>
                                        </div>
                                        <h6 class="card-title mb-1">견적서</h6>
                                        <p class="card-text small text-muted mb-2">1단계</p>
                                        <span class="badge bg-primary">15건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-success h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-success bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-file-contract text-success"></i>
                                        </div>
                                        <h6 class="card-title mb-1">수배서</h6>
                                        <p class="card-text small text-muted mb-2">2단계</p>
                                        <span class="badge bg-success">12건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-warning h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-warning bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-file-invoice-dollar text-warning"></i>
                                        </div>
                                        <h6 class="card-title mb-1">청구서</h6>
                                        <p class="card-text small text-muted mb-2">3단계</p>
                                        <span class="badge bg-warning text-dark">8건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-info h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-info bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-user-check text-info"></i>
                                        </div>
                                        <h6 class="card-title mb-1">고객확인</h6>
                                        <p class="card-text small text-muted mb-2">4단계</p>
                                        <span class="badge bg-info">5건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-secondary h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-secondary bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-clipboard-list text-secondary"></i>
                                        </div>
                                        <h6 class="card-title mb-1">가이드지침서</h6>
                                        <p class="card-text small text-muted mb-2">5단계</p>
                                        <span class="badge bg-secondary">3건</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Documents -->
                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-dark h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-dark bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-bed text-dark"></i>
                                        </div>
                                        <h6 class="card-title mb-1">호텔&기타</h6>
                                        <p class="card-text small text-muted mb-2">부가서류</p>
                                        <span class="badge bg-dark">7건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border border-danger h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-danger bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-flag-checkered text-danger"></i>
                                        </div>
                                        <h6 class="card-title mb-1">Final</h6>
                                        <p class="card-text small text-muted mb-2">최종서류</p>
                                        <span class="badge bg-danger">4건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-percentage text-muted"></i>
                                        </div>
                                        <h6 class="card-title mb-1">수수료</h6>
                                        <p class="card-text small text-muted mb-2">수수료</p>
                                        <span class="badge bg-light text-dark">6건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-calendar-check text-muted"></i>
                                        </div>
                                        <h6 class="card-title mb-1">관광일정승인</h6>
                                        <p class="card-text small text-muted mb-2">승인서류</p>
                                        <span class="badge bg-light text-dark">2건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-check-circle text-muted"></i>
                                        </div>
                                        <h6 class="card-title mb-1">관광확인승인</h6>
                                        <p class="card-text small text-muted mb-2">확인서류</p>
                                        <span class="badge bg-light text-dark">1건</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-2 col-md-4 col-sm-6">
                                <div class="card border h-100 card-hover">
                                    <div class="card-body text-center p-3">
                                        <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center mb-2" 
                                             style="width: 40px; height: 40px;">
                                            <i class="fas fa-tasks text-muted"></i>
                                        </div>
                                        <h6 class="card-title mb-1">업무확인서</h6>
                                        <p class="card-text small text-muted mb-2">확인서류</p>
                                        <span class="badge bg-light text-dark">3건</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workflow Progress Indicator -->
        <div class="row mb-4">
            <div class="col">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent">
                        <h6 class="mb-0">
                            <i class="fas fa-project-diagram me-2"></i>문서 워크플로우
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 40px;">
                                    1
                                </div>
                                <div class="ms-2">
                                    <small class="text-muted">1단계</small><br>
                                    <strong>견적서</strong>
                                </div>
                            </div>
                            
                            <div class="flex-grow-1 mx-3">
                                <hr class="my-0" style="border: 2px solid #dee2e6;">
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 40px;">
                                    2
                                </div>
                                <div class="ms-2">
                                    <small class="text-muted">2단계</small><br>
                                    <strong>수배서</strong>
                                </div>
                            </div>
                            
                            <div class="flex-grow-1 mx-3">
                                <hr class="my-0" style="border: 2px solid #dee2e6;">
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-warning text-white d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 40px;">
                                    3
                                </div>
                                <div class="ms-2">
                                    <small class="text-muted">3단계</small><br>
                                    <strong>청구서</strong>
                                </div>
                            </div>
                            
                            <div class="flex-grow-1 mx-3">
                                <hr class="my-0" style="border: 2px solid #dee2e6;">
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-info text-white d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 40px;">
                                    4
                                </div>
                                <div class="ms-2">
                                    <small class="text-muted">4단계</small><br>
                                    <strong>고객확인</strong>
                                </div>
                            </div>
                            
                            <div class="flex-grow-1 mx-3">
                                <hr class="my-0" style="border: 2px solid #dee2e6;">
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 40px;">
                                    5
                                </div>
                                <div class="ms-2">
                                    <small class="text-muted">5단계</small><br>
                                    <strong>가이드지침서</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3 text-center">
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                문서는 순서대로 작성되어야 하며, 이전 단계가 승인되어야 다음 단계로 진행 가능합니다.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Document List -->
        <div class="row">
            <div class="col">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">
                                <i class="fas fa-list me-2"></i>문서 목록
                            </h6>
                            <div class="btn-group btn-group-sm" role="group">
                                <select class="form-select form-select-sm" id="documentTypeFilter">
                                    <option value="">모든 문서</option>
                                    <option value="QUOTE">견적서</option>
                                    <option value="BOOKING">수배서</option>
                                    <option value="INVOICE">청구서</option>
                                    <option value="CUSTOMER_CONFIRMATION">고객확인</option>
                                    <option value="GUIDE_INSTRUCTION">가이드지침서</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="bg-light">
                                    <tr>
                                        <th scope="col">REF No</th>
                                        <th scope="col">문서타입</th>
                                        <th scope="col">제목</th>
                                        <th scope="col">상태</th>
                                        <th scope="col">금액</th>
                                        <th scope="col">작성자</th>
                                        <th scope="col">작성일</th>
                                        <th scope="col">승인일</th>
                                        <th scope="col">관리</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Sample Document Data -->
                                    <tr>
                                        <td><strong>GF20240115001</strong></td>
                                        <td><span class="badge bg-primary">견적서</span></td>
                                        <td>제주도 3박 4일 여행</td>
                                        <td><span class="badge bg-success">승인완료</span></td>
                                        <td class="text-end">₩8,500,000</td>
                                        <td>김담당</td>
                                        <td>2024.01.10</td>
                                        <td>2024.01.12</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="보기" 
                                                        onclick="viewDocument(1)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editDocument(1)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-success" title="인쇄" 
                                                        onclick="printDocument(1)">
                                                    <i class="fas fa-print"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td><strong>GF20240115001</strong></td>
                                        <td><span class="badge bg-success">수배서</span></td>
                                        <td>제주도 3박 4일 수배</td>
                                        <td><span class="badge bg-warning">승인대기</span></td>
                                        <td class="text-end">₩8,500,000</td>
                                        <td>김담당</td>
                                        <td>2024.01.13</td>
                                        <td>-</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="보기" 
                                                        onclick="viewDocument(2)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editDocument(2)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-info" title="승인" 
                                                        onclick="approveDocument(2)">
                                                    <i class="fas fa-check"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td><strong>GF20240201002</strong></td>
                                        <td><span class="badge bg-primary">견적서</span></td>
                                        <td>부산 2박 3일 여행</td>
                                        <td><span class="badge bg-secondary">작성중</span></td>
                                        <td class="text-end">₩4,200,000</td>
                                        <td>이담당</td>
                                        <td>2024.01.25</td>
                                        <td>-</td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="보기" 
                                                        onclick="viewDocument(3)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editDocument(3)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" title="저장" 
                                                        onclick="saveDocument(3)">
                                                    <i class="fas fa-save"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Document Modal -->
    <div class="modal fade" id="documentModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">문서 작성</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="documentForm" class="needs-validation" novalidate>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="docRefNo" class="form-label">REF No <span class="text-danger">*</span></label>
                                <select class="form-select" id="docRefNo" name="refNo" required>
                                    <option value="">선택하세요</option>
                                    <option value="GF20240115001">GF20240115001 - 제주도 3박 4일</option>
                                    <option value="GF20240201002">GF20240201002 - 부산 2박 3일</option>
                                </select>
                                <div class="invalid-feedback">REF No를 선택해주세요.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="docType" class="form-label">문서타입 <span class="text-danger">*</span></label>
                                <select class="form-select" id="docType" name="type" required>
                                    <option value="">선택하세요</option>
                                    <option value="QUOTE">견적서</option>
                                    <option value="BOOKING">수배서</option>
                                    <option value="INVOICE">청구서</option>
                                    <option value="CUSTOMER_CONFIRMATION">고객확인</option>
                                    <option value="GUIDE_INSTRUCTION">가이드지침서</option>
                                    <option value="HOTEL_OTHERS">호텔&기타</option>
                                    <option value="FINAL">Final</option>
                                    <option value="COMMISSION">수수료</option>
                                </select>
                                <div class="invalid-feedback">문서타입을 선택해주세요.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="docTitle" class="form-label">제목 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="docTitle" name="title" required>
                                <div class="invalid-feedback">제목을 입력해주세요.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="docAmount" class="form-label">금액</label>
                                <div class="input-group">
                                    <span class="input-group-text">₩</span>
                                    <input type="number" class="form-control" id="docAmount" name="amount">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="docStatus" class="form-label">상태</label>
                                <select class="form-select" id="docStatus" name="status">
                                    <option value="DRAFT">작성중</option>
                                    <option value="SUBMITTED">제출됨</option>
                                    <option value="APPROVED">승인완료</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label for="docContent" class="form-label">내용</label>
                                <textarea class="form-control" id="docContent" name="content" rows="8" 
                                          placeholder="문서 내용을 입력하세요..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-outline-primary" id="previewDocument">미리보기</button>
                    <button type="button" class="btn btn-primary" id="saveDocument">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Document management functions
            window.viewDocument = function(id) {
                console.log('View document:', id);
            };

            window.editDocument = function(id) {
                console.log('Edit document:', id);
                const modal = new bootstrap.Modal(document.getElementById('documentModal'));
                modal.show();
            };

            window.printDocument = function(id) {
                console.log('Print document:', id);
            };

            window.approveDocument = function(id) {
                if (confirm('이 문서를 승인하시겠습니까?')) {
                    console.log('Approve document:', id);
                    alert('문서가 승인되었습니다.');
                }
            };

            window.saveDocument = function(id) {
                console.log('Save document:', id);
                alert('문서가 저장되었습니다.');
            };

            // Form handling
            document.getElementById('saveDocument').addEventListener('click', function() {
                const form = document.getElementById('documentForm');
                if (form.checkValidity()) {
                    console.log('Save new document');
                    const modal = bootstrap.Modal.getInstance(document.getElementById('documentModal'));
                    modal.hide();
                    alert('문서가 저장되었습니다.');
                } else {
                    form.classList.add('was-validated');
                }
            });

            // Preview functionality
            document.getElementById('previewDocument').addEventListener('click', function() {
                console.log('Preview document');
                alert('문서 미리보기 기능은 개발 중입니다.');
            });

            // Filter functionality
            document.getElementById('documentTypeFilter').addEventListener('change', function() {
                const filterValue = this.value;
                console.log('Filter by document type:', filterValue);
                // Implement filtering logic here
            });
        });
    </script>
</body>
</html>