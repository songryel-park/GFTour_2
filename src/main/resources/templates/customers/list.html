<!DOCTYPE html>
<html lang="ko" 
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      th:replace="~{layout/base :: html}">
<head>
    <meta charset="UTF-8">
    <title>고객 명단 - Good Feel Tour</title>
</head>
<body>
    <div th:block="content">
        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="gf-secondary mb-0">
                            <i class="fas fa-users me-2"></i>고객 명단
                        </h2>
                        <p class="text-muted mb-0">고객 정보를 관리합니다. (이름, 나이, 여권번호)</p>
                    </div>
                    <div>
                        <button type="button" class="btn btn-gf-primary" data-bs-toggle="modal" data-bs-target="#customerModal">
                            <i class="fas fa-user-plus me-2"></i>고객 등록
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search and Statistics -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-search"></i>
                                    </span>
                                    <input type="text" class="form-control" placeholder="이름 또는 여권번호 검색" 
                                           id="searchInput">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="ageFilter">
                                    <option value="">연령대 전체</option>
                                    <option value="child">어린이 (0-12세)</option>
                                    <option value="teen">청소년 (13-19세)</option>
                                    <option value="adult">성인 (20-64세)</option>
                                    <option value="senior">고령자 (65세 이상)</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <div class="btn-group w-100" role="group">
                                    <button type="button" class="btn btn-outline-primary" id="searchBtn">
                                        <i class="fas fa-search me-1"></i>검색
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" id="resetBtn">
                                        <i class="fas fa-undo me-1"></i>초기화
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <select class="form-select" id="pageSize">
                                    <option value="10">10개씩 보기</option>
                                    <option value="20">20개씩 보기</option>
                                    <option value="50">50개씩 보기</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-4">
                                <h5 class="text-primary mb-0">125</h5>
                                <small class="text-muted">총 고객수</small>
                            </div>
                            <div class="col-4">
                                <h5 class="text-success mb-0">23</h5>
                                <small class="text-muted">이번 달</small>
                            </div>
                            <div class="col-4">
                                <h5 class="text-warning mb-0">8</h5>
                                <small class="text-muted">VIP 고객</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Customer Table -->
        <div class="row">
            <div class="col">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">
                                <i class="fas fa-list me-2"></i>고객 목록 
                                <span class="badge bg-primary ms-2">6건</span>
                            </h6>
                            <div class="btn-group btn-group-sm" role="group">
                                <button type="button" class="btn btn-outline-success" id="exportExcel">
                                    <i class="fas fa-file-excel me-1"></i>Excel 내보내기
                                </button>
                                <button type="button" class="btn btn-outline-info" id="sendMessage">
                                    <i class="fas fa-envelope me-1"></i>단체 메시지
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="bg-light">
                                    <tr>
                                        <th scope="col" width="5%">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="selectAll">
                                            </div>
                                        </th>
                                        <th scope="col">이름</th>
                                        <th scope="col">나이</th>
                                        <th scope="col">여권번호</th>
                                        <th scope="col">연락처</th>
                                        <th scope="col">여행횟수</th>
                                        <th scope="col">최근 여행</th>
                                        <th scope="col">고객 등급</th>
                                        <th scope="col" width="15%">관리</th>
                                    </tr>
                                </thead>
                                <tbody id="customerTableBody">
                                    <!-- Sample Customer Data -->
                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="1">
                                            </div>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2" 
                                                     style="width: 35px; height: 35px; font-size: 14px;">
                                                    김
                                                </div>
                                                <div>
                                                    <strong>김여행</strong>
                                                    <br><small class="text-muted">kim@email.com</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-info">32세</span></td>
                                        <td><code>M12345678</code></td>
                                        <td>
                                            <i class="fas fa-phone text-muted me-1"></i>010-1234-5678
                                        </td>
                                        <td>
                                            <span class="badge bg-success">3회</span>
                                        </td>
                                        <td>제주도 (2024.01.15)</td>
                                        <td><span class="badge bg-warning text-dark">VIP</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="상세보기" 
                                                        onclick="viewCustomer(1)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-info" title="여행 이력" 
                                                        onclick="viewTravelHistory(1)">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editCustomer(1)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="2">
                                            </div>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="avatar-sm bg-success text-white rounded-circle d-flex align-items-center justify-content-center me-2" 
                                                     style="width: 35px; height: 35px; font-size: 14px;">
                                                    이
                                                </div>
                                                <div>
                                                    <strong>이관광</strong>
                                                    <br><small class="text-muted">lee@email.com</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-info">28세</span></td>
                                        <td><code>M87654321</code></td>
                                        <td>
                                            <i class="fas fa-phone text-muted me-1"></i>010-8765-4321
                                        </td>
                                        <td>
                                            <span class="badge bg-secondary">1회</span>
                                        </td>
                                        <td>부산 (2024.02.01)</td>
                                        <td><span class="badge bg-light text-dark">일반</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="상세보기" 
                                                        onclick="viewCustomer(2)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-info" title="여행 이력" 
                                                        onclick="viewTravelHistory(2)">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editCustomer(2)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="3">
                                            </div>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="avatar-sm bg-warning text-white rounded-circle d-flex align-items-center justify-content-center me-2" 
                                                     style="width: 35px; height: 35px; font-size: 14px;">
                                                    박
                                                </div>
                                                <div>
                                                    <strong>박투어</strong>
                                                    <br><small class="text-muted">park@email.com</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-info">45세</span></td>
                                        <td><code>M11223344</code></td>
                                        <td>
                                            <i class="fas fa-phone text-muted me-1"></i>010-1122-3344
                                        </td>
                                        <td>
                                            <span class="badge bg-danger">5회</span>
                                        </td>
                                        <td>서울 (2024.01.30)</td>
                                        <td><span class="badge bg-warning text-dark">VIP</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary" title="상세보기" 
                                                        onclick="viewCustomer(3)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-info" title="여행 이력" 
                                                        onclick="viewTravelHistory(3)">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" title="수정" 
                                                        onclick="editCustomer(3)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pagination -->
        <div class="row mt-4">
            <div class="col">
                <nav aria-label="페이지 네비게이션">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled">
                            <a class="page-link" href="#" aria-label="이전">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#" aria-label="다음">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <!-- Customer Modal -->
    <div class="modal fade" id="customerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">고객 정보</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="customerForm" class="needs-validation" novalidate>
                        <input type="hidden" id="customerId" name="id">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="customerName" class="form-label">이름 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="customerName" name="name" required>
                                <div class="invalid-feedback">이름을 입력해주세요.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="customerAge" class="form-label">나이 <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="customerAge" name="age" 
                                       min="0" max="150" required>
                                <div class="invalid-feedback">나이를 입력해주세요.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="passportNumber" class="form-label">여권번호 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="passportNumber" name="passportNumber" 
                                       placeholder="M12345678" maxlength="9" required>
                                <div class="invalid-feedback">여권번호를 입력해주세요.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="phoneNumber" class="form-label">전화번호</label>
                                <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber" 
                                       placeholder="010-1234-5678">
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">이메일</label>
                                <input type="email" class="form-control" id="email" name="email" 
                                       placeholder="customer@email.com">
                            </div>
                            <div class="col-md-6">
                                <label for="customerGrade" class="form-label">고객 등급</label>
                                <select class="form-select" id="customerGrade" name="grade">
                                    <option value="일반">일반</option>
                                    <option value="VIP">VIP</option>
                                    <option value="VVIP">VVIP</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label for="customerNotes" class="form-label">비고</label>
                                <textarea class="form-control" id="customerNotes" name="notes" rows="2" 
                                          placeholder="고객 관련 특이사항을 입력하세요..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" id="saveCustomer">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Travel History Modal -->
    <div class="modal fade" id="travelHistoryModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">여행 이력</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead class="bg-light">
                                <tr>
                                    <th>REF No</th>
                                    <th>여행지</th>
                                    <th>여행 기간</th>
                                    <th>참가자 수</th>
                                    <th>금액</th>
                                    <th>상태</th>
                                    <th>만족도</th>
                                </tr>
                            </thead>
                            <tbody id="travelHistoryBody">
                                <!-- Travel history data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Customer management functions
            window.viewCustomer = function(id) {
                console.log('View customer:', id);
                // Implementation for viewing customer details
            };

            window.editCustomer = function(id) {
                console.log('Edit customer:', id);
                const modal = new bootstrap.Modal(document.getElementById('customerModal'));
                // Load customer data and populate form
                modal.show();
            };

            window.viewTravelHistory = function(id) {
                console.log('View travel history for customer:', id);
                const modal = new bootstrap.Modal(document.getElementById('travelHistoryModal'));
                
                // Sample travel history data
                const historyData = [
                    {refNo: 'GF20240115001', destination: '제주도 3박 4일', period: '2024.01.15 ~ 01.18', participants: 2, amount: '₩850,000', status: '완료', satisfaction: '★★★★★'},
                    {refNo: 'GF20231201002', destination: '부산 2박 3일', period: '2023.12.01 ~ 12.03', participants: 1, amount: '₩320,000', status: '완료', satisfaction: '★★★★☆'},
                    {refNo: 'GF20230815003', destination: '서울 당일투어', period: '2023.08.15', participants: 1, amount: '₩85,000', status: '완료', satisfaction: '★★★☆☆'}
                ];
                
                const tbody = document.getElementById('travelHistoryBody');
                tbody.innerHTML = '';
                
                historyData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${item.refNo}</strong></td>
                        <td>${item.destination}</td>
                        <td>${item.period}</td>
                        <td><span class="badge bg-info">${item.participants}명</span></td>
                        <td>${item.amount}</td>
                        <td><span class="badge bg-success">${item.status}</span></td>
                        <td>${item.satisfaction}</td>
                    `;
                    tbody.appendChild(row);
                });
                
                modal.show();
            };

            // Checkbox selection functionality
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('tbody input[type="checkbox"]');

            selectAll.addEventListener('change', function() {
                checkboxes.forEach(cb => cb.checked = this.checked);
            });

            // Search functionality
            document.getElementById('searchBtn').addEventListener('click', function() {
                const searchTerm = document.getElementById('searchInput').value;
                const ageFilter = document.getElementById('ageFilter').value;
                
                console.log('Search customers:', { searchTerm, ageFilter });
                // Implement search functionality
            });

            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('searchInput').value = '';
                document.getElementById('ageFilter').value = '';
            });

            // Customer form handling
            document.getElementById('saveCustomer').addEventListener('click', function() {
                const form = document.getElementById('customerForm');
                if (form.checkValidity()) {
                    console.log('Save customer');
                    const modal = bootstrap.Modal.getInstance(document.getElementById('customerModal'));
                    modal.hide();
                } else {
                    form.classList.add('was-validated');
                }
            });

            // Export functionality
            document.getElementById('exportExcel').addEventListener('click', function() {
                console.log('Export customers to Excel');
            });

            document.getElementById('sendMessage').addEventListener('click', function() {
                console.log('Send group message to customers');
            });
        });
    </script>
</body>
</html>